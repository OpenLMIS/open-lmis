<!--
  ~ Copyright Â© 2013 John Snow, Inc. (JSI). All Rights Reserved.
  ~
  ~ The U.S. Agency for International Development (USAID) funded this section of the application development under the terms of the USAID | DELIVER PROJECT contract no. GPO-I-00-06-00007-00.
  -->
<div xmlns="http://www.w3.org/1999/html" tab-scroll>
<h2>
    <span>{{title}}</span>
</h2>

<div class="alert alert-success" id="saveSuccessMsgDiv" ng-bind="message" ng-show="message"/>

<!-------------------------------------------------------------------------------------------------------------
Edit Product
 -------------------------------------------------------------------------------------------------------------->
<form name="editProductForm"
      ng-submit="updateProduct();"
     novalidate select2-blur>
    <input type="hidden" ng-model="backupProductRow"/>
    <div ng-class="editProductMode">
    <div class="row-fluid list-row" ng-show="editProductMode">
    <div class="app-form">
<div class="form-group">
<h3>Basic Information</h3>

<div class="form-row clearfix">
<div class="form-cell">
    <label for="code">Code
        <span ng-show="editProduct" class="label-required">*</span>
    </label>


    <div class="form-field" style="width: 40%;">

        <input ng-model="editProduct.code" name="code" id="code_edt" type="text" value="{{editProduct.code}}"
               ng-show="editProduct"
               maxlength="20"

               ng-required="true"/>
                                        <span class="field-error"
                                              ng-show="editProductForm.code.$error.required && showErrorForCreate"
                                              openlmis-message="missing.value">
                                        </span>
    </div>
</div>

<!-- Product Pack Size-->
<div class="form-cell">
    <label for="packSize">Pack Size
        <span ng-show="editProduct" class="label-required">*</span>
    </label>

    <div class="form-field" style="width: 40%;">
        <input ng-model="editProduct.packSize" type="text"
               ng-show="editProduct"
               maxlength="20"
               ng-required="true"/>
                                        <span class="field-error"
                                              ng-show="editProductForm.packSize.$error.required && showErrorForCreate"
                                              openlmis-message="missing.value">
                                        </span>
    </div>
</div>

<!-- product name-->
<div class="form-cell">
    <label for="primaryName_edt">Product Name <span ng-show="editProduct" class="label-required">*</span>
    </label>

    <div class="form-field" style="width: 40%;">
        <input ng-model="editProduct.primaryName" name="primaryName" id="primaryName_edt" type="text"
               ng-show="editProduct"
               maxlength="20"
               ng-required="true"/>
                                        <span class="field-error"
                                              ng-show="editProductForm.fullName.$error.required && showErrorForCreate"
                                              openlmis-message="missing.value">
                                        </span>
    </div>
</div>

<!-- Dispensing Units-->
<div class="form-cell">
    <label for="dispensingUnit">Dispensing Unit
        <span ng-show="editProduct" class="label-required">*</span>
    </label>

    <div class="form-field" style="width: 40%;">
        <input ng-model="editProduct.dispensingUnit" name="dispensingUnit" id="dispensingUnit_edt"
               type="text"
               ng-show="editProduct"
               maxlength="20"
               ng-required="true"/>
                                        <span class="field-error"
                                              ng-show="editProductForm.dispensingUnit.$error.required && showErrorForCreate"
                                              openlmis-message="missing.value">
                                        </span>

    </div>
</div>

<!-- Dosage Per Dispensing Units-->
<div class="form-cell">
    <label for="dispensingUnit">Doses Per Dispensing Unit
        <span ng-show="editProduct" class="label-required">*</span>
    </label>

    <div class="form-field" style="width: 40%;">
        <input ng-model="editProduct.dosesPerDispensingUnit" name="dispensingUnit" id="dosesPerDispensingUnit_edt"
               type="text"
               ng-show="editProduct"
               maxlength="20"
               ng-required="true"/>
            <span class="field-error"
                  ng-show="editProductForm.dosesPerDispensingUnit.$error.required && showErrorForCreate"
                  openlmis-message="missing.value">
            </span>

    </div>
</div>

<!-- Thresh hold-->
<div class="form-cell">
    <label for="packRoundingThreshold">Threshold
        <span ng-show="editProduct" class="label-required">*</span>
    </label>

    <div class="form-field" style="width: 40%;">
        <input ng-model="editProduct.packRoundingThreshold" name="packRoundingThreshold" id="packRoundingThreshold_edt"
               type="text"
               ng-show="editProduct"
               maxlength="20"
               ng-required="true"/>
            <span class="field-error"
                  ng-show="editProductForm.packRoundingThreshold.$error.required && showErrorForCreate"
                  openlmis-message="missing.value">
            </span>
    </div>
</div>

<!-- product strength-->
<div class="form-cell">
    <label for="strength">Strength</label>

    <div class="form-field" style="width: 40%;">
        <input ng-model="editProduct.strength" name="strength" id="strength_edt" type="text"
               ng-show="editProduct"
               maxlength="20"/>
                                        <span class="field-error"
                                              ng-show="editProductForm.strength.$error.required && showErrorForCreate"
                                              openlmis-message="missing.value">
                                        </span>
    </div>
</div>

<!-- Type-->
<div class="form-cell">
    <label for="type">Type</label>

    <div class="form-field" style="width: 40%;">
        <input ng-model="editProduct.type" name="type" id="type_edt" type="text"
               ng-show="editProduct"
               maxlength="20"/>
                                        <span class="field-error"
                                              ng-show="editProductForm.type.$error.required && showErrorForCreate"
                                              openlmis-message="missing.value">
                                        </span>
    </div>
</div>

<!-- Dosage Units-->
<div class="form-cell">
    <label for="dosageUnitId_edt">Dosage Unit</label>

    <div class="form-field" style="width: 40%;">
        <select ui-select2
                style="width:200px;"
                ng-model="editProduct.dosageUnitId"
                ng-show="editProduct"
                ng-options="option.id as option.code for option in dosageUnits">
        </select>
        <span
                class="field-error"
                ng-show="editProductForm.dosageUnitId.$error.required && showErrorForCreate"
             openlmis-message="missing.value">
        </span>
    </div>
</div>


<!-- Product Display Order-->
<div class="form-cell">
    <label for="displayOrder">Display Order</label>
    <div class="form-field" style="width: 40%;">
        <input
                ng-model="editProduct.displayOrder"
                name="displayOrder"
                id="displayOrder_edt"
                type="text"
                ng-show="editProduct"
                maxlength="20"/>
                <span class="field-error"
                      ng-show="editProductForm.displayOrder.$error.required && showErrorForCreate"
                      openlmis-message="missing.value">
                </span>
    </div>
</div>

<!-- Product Form-->
<div class="form-cell">
    <label for="formid_edt">Product Form</label>
    <div class="form-field" style="width: 40%;">
           <select ui-select2 style="width:200px;" name="formId" id="formid_edt"
                ng-model="editProduct.formId"
                ng-show="editProduct"
                ng-options="option.id as option.code for option in productForms">
           </select>
           <span class="field-error"
                 ng-show="editProductForm.productForm.$error.required && showErrorForCreate"
                 openlmis-message="missing.value">
            </span>
    </div>
</div>


<!-- Product Categories-->
<div class="form-cell">
    <label for="categoryid">Category</label>

    <div class="form-field" style="width: 40%;">

        <select ui-select2 style="width:200px;" name="categoryid" id="categoryid_edt" ng-model="editProduct.categoryId"
                ng-show="editProduct"
                ng-options="option.id as option.name for option in productCategories">

        </select>
                                       <span class="field-error"
                                             ng-show="editProductForm.productDisplayOrder.$error.required && showErrorForCreate"
                                             openlmis-message="missing.value">
                                        </span>
    </div>
</div>

<!-- Product Groups-->
<div class="form-cell">
    <label for="productGroupId">Product Group</label>

    <div class="form-field" style="width: 40%;">

        <select ui-select2 style="width:200px;" ng-model="editProduct.productGroupId"
                ng-options="option.id as option.name for option in productGroups">

        </select>
       <span class="field-error"
             ng-show="createProductForm.productGroupId.$error.required && showErrorForCreate"
             openlmis-message="missing.value">
        </span>
    </div>
</div>


<div class="form-cell"></div>

<!-- Product Full Supply-->
<div class="form-cell" style="margin-left: 30px;">
    <div class="form-field" style="width: 40%;">
        <table>
            <tr>
                <td><input ng-model="editProduct.fullSupply" name="fullSupply" id="fullSupply_edt"
                           type="checkbox"
                           ng-show="editProduct"
                           ng-required="false"/>
                </td>
                <td>&nbsp;</td>
                </td>
                <td>Full Supply</td>
            </tr>
            <tr>
                <td>
                    <input ng-model="editProduct.tracer" name="tracer" id="tracer_edt" type="checkbox"
                           ng-show="editProduct"
                           ng-required="false"/>
                </td>
                <td>&nbsp;</td>
                </td>
                <td>Tracer</td>
            </tr>
            <tr>
                <td>
                    <input ng-model="editProduct.active" name="active" id="active_edt" type="checkbox"
                           ng-show="editProduct"
                           ng-required="false"/>
                </td>
                <td>&nbsp;</td>
                </td>
                <td>Active</td>
            </tr>
            <tr>
                <td>
                    <input ng-model="product.roundToZero" name="roundToZero" id="roundToZero_edt" type="checkbox"
                           ng-show="editProduct"
                           ng-checked="editProduct.roundToZero"
                           ng-required="false"/>
                </td>
                <td>&nbsp;</td>
                </td>
                <td>Round to Zero</td>
            </tr>


        </table>
    </div>
</div>

</div>
</div>
<!--basic information-->

<div class="form-group">
    <h3>Program Association</h3>

    <table border="0">
        <tr>
            <th></th>
            <th style="text-align:left;">Program</th>
            <th></th>
            <th style="text-align: left">Price Per Pack</th>
            <th style="text-align: left">Doses Per Month</th>
        </tr>
        <tr ng-repeat="pp in editProduct.programProducts" tab-scroll>
            <td >&nbsp;</td>
            <td style="width: 200px;text-align:left;">{{pp.program.code}}</td>
            <td style="width: 200px;text-align:left;">
                <input type="checkbox"
                       ng-model="pp.active"/>
            </td>
            <td><input type="text" ng-disabled="!pp.active" ng-required="pp.active" ng-model="pp.currentPrice"/></td>
            <td><input type="text" ng-disabled="!pp.active" ng-required="pp.active" ng-model="pp.dosesPerMonth"/></td>
        </tr>
    </table>
</div>

</div>
</div>

  <div form-toolbar id="action_buttons_edit" class="action-buttons" ng-show="editProductMode">
    <div class="form-cell button-row">
        <input type="submit" class="btn btn-primary save-button" openlmis-message="button.save"/>
        <a href="" class="btn btn-danger delete-button" style="margin-right: 50px;" ng-show="editProduct.active"
           ng-click="showConfirmProductDeleteWindow(product); productsBackupMap[product.id].deleted=true;">Deactivate</a>
        <a href="" class="btn btn-danger delete-button" style="margin-right: 50px;" ng-hide="editProduct.active"
           ng-click="showConfirmProductRestoreWindow(product); productsBackupMap[product.id].restore=true;">Restore</a>
        <a href="#list"
           class="btn btn-cancel cancel-button"><span openlmis-message="button.cancel"></span></a>
   </div>
   <div class="toolbar-error" id="ediErrorMsgDiv" openlmis-message="error" ng-show="error"/>
</div>
</div>
</form>

<div>
    <h2><span>Price History</span></h2>
    <table class="table table-striped table-bordered">

        <!-- column headers-->
        <thead>
        <tr class="gradient-header">
            <th>Program</th>
            <th>Price Per Pack</th>
            <th>Doses Per Month</th>
            <th>Start Date</th>
            <th>End Date</th>
        </tr>
        </thead>


        <tbody>
        <!--repeat-->
        <tr ng-repeat="cost in priceHistory | orderBy:'startdate':true">

            <!-- Program-->
            <td>
                <div>{{cost.programname}}</div>
            </td>
            <!-- Price Per Pack-->
            <td>
                <div>{{cost.priceperpack}}</div>
            </td>
            <!-- Price Per Pack-->
            <td>
                <div>{{cost.dosespermonth}}</div>
            </td>
            <!-- Price Per Pack-->

            <!-- Start Date-->
            <td>
                <div>{{cost.startdate | date:'dd/MM/yyyy hh:mm:ss'}}</div>
            </td>
            <!-- End Date-->
            <td>
                <div>{{cost.enddate | date:'dd/MM/yyyy hh:mm:ss'}}</div>
            </td>
        <tr>
        </tbody>
    </table>
</div>

</div>




