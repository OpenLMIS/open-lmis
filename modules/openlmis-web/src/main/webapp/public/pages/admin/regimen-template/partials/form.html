<!--
  ~ Copyright Â© 2013 VillageReach.  All Rights Reserved.  This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
  ~
  ~ If a copy of the MPL was not distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.
  -->

<div tab-scroll xmlns="http://www.w3.org/1999/html">
  <h2 openlmis-message="label.admin.configure.regimenTemplate"></h2>

  <div class="info-box">
    <p><strong openlmis-message="template.programName"></strong> <span ng-bind="program.name"></span> <a
      ng-href="{{selectProgramUrl}}"
      openlmis-message="template.change"></a>
    </p>
  </div>

  <div class="list-header row-fluid">
      <div class="span3" openlmis-message="label.regimen.category"></div>
      <div class="span3" openlmis-message="header.code"></div>
      <div class="span3" openlmis-message="header.name"></div>
      <div class="span3" openlmis-message="label.active"></div>
  </div>

  <form name="newRegimenForm">
    <div class="list-row">
    <div class="row-fluid">
      <div class="span3"><span>
        <select id="new-regimen-category"
                 ng-model="newRegimen.category"
                 ng-options="regimenCategory as regimenCategory.name for regimenCategory in regimenCategories"
                 ng-required="true"
                 ng-class="highlightRequired(newRegimen.category)">
        </select>
      </span></div>
      <div class="span3"><span>
        <input type="text" id="new-regimen-code" name="newRegimenCode" ng-model="newRegimen.code" ng-required="true" ng-class="highlightRequired(newRegimen.code)"/></span>
      </div>
      <div class="span3"><span>
        <input type="text" id="new-regimen-name" name="newRegimenName" ng-model="newRegimen.name" ng-required="true" ng-class="highlightRequired(newRegimen.name)"/></span>
      </div>
      <div class="span3"><span>
        <input type="checkbox" id="new-regimen-active" name="newRegimenActive" ng-model="newRegimen.active" ng-required="true" ng-class="highlightRequired(newRegimen.active)"/></span>
      </div>
    </div>
      <input type="button" class="btn btn-primary" id="add-new-regimen" openlmis-message="button.add" ng-click="addNewRegimen()" />
    </div>
    <div class="alert alert-error" id="addFailMessage" openlmis-message="newRegimenError" ng-show="newRegimenError">
    </div>
  </form>


  <form name="regimenEditForm" id="regimen-edit-form" ng-submit="save()">

    <div class="rnr-template-head">
      <span class="tpl-visible" openlmis-message="label.active"></span>
      <span class="tpl-label" openlmis-message="header.code"></span>
      <span class="tpl-label" openlmis-message="header.name"></span>
      <span></span>
    </div>

    <div class="rnr-template-columns">
      <ul ng-model="regimenCategories" ng-repeat="category in regimenCategories">
        <li class="category-name">
          <span ng-show="regimensByCategory[category.id].length > 0" ng-bind="category.name"></span>
        </li>
        <div class="rnr-template-columns">
        <ul ui-sortable ng-model="regimensByCategory[category.id]" id="sortable">
          <li ng-repeat="regimen in regimensByCategory[category.id]">
            <div class="drag-handle"></div>
            <span class="tpl-visible">
              <input type="checkbox" ng-model="regimen.active" ng-disabled="regimen.disable"/>
            </span>
            <span class="tpl-label">
              <input name="regimenCode" type="text" ng-model="regimen.code" ng-required="true"
                     ng-disabled="regimen.disable"/>
            </span>
            <span class="tpl-label">
              <input name="regimenName" type="text" ng-model="regimen.name" ng-required="true"
                     ng-disabled="regimen.disable"/>
            </span>
            <span ng-show="regimen.disable">
              <input name="button" type="button" class= "btn btn-mini" value="Edit" ng-click="editRow(regimen)"/>
            </span>
            <span ng-show="!regimen.disable">
              <input name="button" type="button" class= "btn btn-mini" value="Done" ng-click="saveRow(regimen)"/>
            </span>
          </li>
        </ul>
          </div>
      </ul>
    </div>

    <div form-toolbar class="action-buttons">
      <div class="form-cell button-row">
        <input type="submit" class="btn btn-primary save-button" openlmis-message="button.save"/>
        <a ng-href="{{selectProgramUrl}}" class="btn btn-cancel cancel-button" openlmis-message="button.cancel"></a>
      </div>
      <div class="toolbar-error" id="saveErrorMsgDiv" openlmis-message="error" ng-show="error"></div>
    </div>


  </form>
</div>
